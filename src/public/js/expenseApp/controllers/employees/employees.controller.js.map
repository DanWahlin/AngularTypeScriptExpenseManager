{"version":3,"sources":["expenseApp/controllers/employees/employees.controller.ts"],"names":["expenseApp","expenseApp.employees","expenseApp.employees.EmployeesController","expenseApp.employees.EmployeesController.constructor","expenseApp.employees.EmployeesController.pageChanged","expenseApp.employees.EmployeesController.deleteEmployee","expenseApp.employees.EmployeesController.changeDisplayMode","expenseApp.employees.EmployeesController.navigate","expenseApp.employees.EmployeesController.setOrder","expenseApp.employees.EmployeesController.searchTextChanged","expenseApp.employees.EmployeesController.getEmployeesSummary","expenseApp.employees.EmployeesController.filterEmployees","expenseApp.employees.EmployeesController.pageRecords","expenseApp.employees.EmployeesController.getEmployeeById"],"mappings":"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","file":"expenseApp/controllers/employees/employees.controller.js","sourcesContent":["namespace expenseApp.employees {\n\n    interface IPagingInfo {\n        currentPage: number;\n        totalRecords: number;\n        pageStart: number;\n        pageEnd: number;\n        pagedEmployeeLength: number;\n        numRecordsDisplaying: number;\n    }\n\n    class EmployeesController {\n\n        employees = [];\n        filteredEmployees = [];\n        pagedEmployees = [];\n        filteredCount: number = 0;\n        orderby: string = 'lastName';\n        reverse: boolean = false;\n        searchText: string = null;\n        cardAnimationClass: string = 'card-animation';\n        listDisplayModeEnabled: boolean;\n        pagingInfo: any;\n        DisplayMode = {\n            Card: 0,\n            List: 1\n        };\n\n        //paging\n        totalRecords: number = 0;\n        pageSize: number = 10;\n        currentPage: number = 1;\n        numRecordsDisplaying: number;\n\n        static $inject = ['$location', '$filter', '$window', '$timeout',\n                          'expenseApp.services.dataService', 'expenseApp.services.modalService'];\n        constructor(private $location: ng.ILocationService, private $filter: ng.IFilterService,\n                    private $window: ng.IWindowService, private $timeout: ng.ITimeoutService,\n                    private dataService, private modalService) {\n            this.getEmployeesSummary();\n        }\n\n        pageChanged(page) {\n            this.currentPage = page;\n            this.pageRecords();\n        }\n\n        deleteEmployee(id: number) {\n\n            var emp: shared.IEmployee = this.getEmployeeById(id);\n            var empName: string = emp.name.first + ' ' + emp.name.last;\n\n            var modalOptions = {\n                closeButtonText: 'Cancel',\n                actionButtonText: 'Delete Employee',\n                headerText: 'Delete ' + empName + '?',\n                bodyText: 'Are you sure you want to delete this employee?'\n            };\n\n            this.modalService.showModal({}, modalOptions).then((result) => {\n                if (result === 'ok') {\n                    this.dataService.deleteEmployee(emp).then(() => {\n                        for (var i = 0; i < this.employees.length; i++) {\n                            if (this.employees[i].id === id) {\n                                this.employees.splice(i, 1);\n                                break;\n                            }\n                        }\n                        this.filterEmployees();\n                    }, (error) => {\n                        this.$window.alert('Error deleting employee: ' + error.message);\n                    });\n                }\n            });\n        }\n\n        changeDisplayMode(displayMode) {\n            switch (displayMode) {\n                case this.DisplayMode.Card:\n                    this.listDisplayModeEnabled = false;\n                    break;\n                case this.DisplayMode.List:\n                    this.listDisplayModeEnabled = true;\n                    break;\n            }\n        }\n\n        navigate(url) {\n            this.$location.path(url);\n        }\n\n        setOrder(orderby) {\n            if (orderby === this.orderby) {\n                this.reverse = !this.reverse;\n            }\n            this.orderby = orderby;\n        }\n\n        searchTextChanged() {\n            this.filterEmployees();\n        }\n\n        getEmployeesSummary() {\n            this.dataService.getEmployeesSummary(this.currentPage - 1, this.pageSize)\n            .then((data: shared.IPagedResult) => {\n                this.totalRecords = data.totalRecords;\n                this.employees = data.results;\n                this.filterEmployees(); //Trigger initial filter\n\n                this.$timeout(() => {\n                    this.cardAnimationClass = ''; //Turn off animation\n                }, 1000);\n\n            }, (error: shared.IHttpPromiseCallbackErrorArg) => {\n                this.$window.alert('Sorry, an error occurred: ' + error.data.message);\n            });\n        }\n\n        filterEmployees() {\n            this.filteredEmployees = this.$filter('nameCityStateFilter')(this.employees, this.searchText);\n            this.filteredCount = this.filteredEmployees.length;\n\n            //Factor in paging\n            this.currentPage = 1;\n            this.totalRecords = this.filteredCount;\n            this.pageRecords();\n        }\n\n        pageRecords() {\n            var useFiltered = this.searchText && this.searchText.length > 0,\n                pageStart = (this.currentPage - 1) * this.pageSize,\n                pageEnd = pageStart + this.pageSize;\n\n            if (useFiltered) {\n                if (pageEnd > this.filteredCount) { pageEnd = this.filteredCount; }\n            } else {\n                if (pageEnd > this.employees.length) { pageEnd = this.employees.length; }\n                this.totalRecords = this.employees.length;\n            }\n\n            this.pagedEmployees = (useFiltered) ? this.filteredEmployees.slice(pageStart, pageEnd)\n                                                : this.employees.slice(pageStart, pageEnd);\n            this.numRecordsDisplaying = this.pagedEmployees.length;\n            this.pagingInfo = {\n                currentPage: this.currentPage,\n                totalRecords: this.totalRecords,\n                pageStart: pageStart,\n                pageEnd: pageEnd,\n                pagedEmployeeLength: this.pagedEmployees.length,\n                numRecordsDisplaying: this.numRecordsDisplaying\n            };\n        }\n\n        getEmployeeById(id: number) : shared.IEmployee {\n            for (var i = 0; i < this.employees.length; i++) {\n                var emp = this.employees[i];\n                if (emp.id === id) {\n                    return emp;\n                }\n            }\n            return null;\n        }\n\n    }\n\n    angular.module('expenseApp').controller('expenseApp.employees.EmployeesController', EmployeesController);\n\n}\n"],"sourceRoot":"/source/"}